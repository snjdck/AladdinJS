const DisplayObject3D = require("./DisplayObject3D");

class DisplayObjectContainer3D extends DisplayObject3D
{
	constructor(){
		super();
		this._children = [];
		this.mouseChildren = true;
	}

	get numChildren(){
		return this._children.length;
	}

	isIndexValid(index){
		return index >= 0 && index < this.numChildren;
	}

	addChild(child){
		this.addChildAt(child, this.numChildren);
	}

	addChildAt(child, index){
		this._children[index] = child;
		child.parent = this;
	}

	onUpdate(timeElapsed){
		super.onUpdate(timeElapsed);
		for(var child of this._children){
			if(child.isVisible()){
				child.onUpdate(timeElapsed);
			}
		}
	}

	collectDrawUnits(collector, gl, mode){
		for(var child of this._children){
			if(!child.isVisible()){
				continue;
			}
			child.collectDrawUnits(collector, gl, mode);
		}
	}

	forEach(handler){
		handler(this);
		for(let child of this._children){
			if(child instanceof DisplayObjectContainer3D){
				child.forEach(handler);
			}else{
				handler(child);
			}
		}
	}
}

module.exports = DisplayObjectContainer3D;