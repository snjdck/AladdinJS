'use strict';

const createSocket = require('./lumi');

const socket = createSocket({
	'5ce50cb6586c': '2491300867594075',
});

socket.once('gateway', function(msg, address){
	msg.dev_list.forEach(v => this.doRead(v.sid, console.log));
	const plug = msg.dev_list.find(v => v.model == 'plug');
	let channel_0 = 'on';
	setInterval(() => {
		this.doWrite(plug.sid, [{channel_0}]);
		channel_0 = channel_0 == 'on' ? 'off' : 'on';
	}, 5000);
});

socket.on('report', function(msg){
	console.log(msg);
});
