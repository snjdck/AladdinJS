'use strict';

const load = require('../net/load');

const root = 'http://www.yizidy.com';

async function main(id, index=0){
	let data = await load(`${root}/vod/${id}/play.html`);
	let a = /<!--播放开始-->(.+?)<!--播放结束-->/s.exec(data)[1];
	let list = a.match(/<script .+?<\/script>/g);
	let c = /<script language="javascript">(.+?)<\/script>/.exec(list.shift())[1];
	c = JSON.parse(c.slice(c.indexOf(`'`)+1, c.lastIndexOf(`'`)));
	const {playurls} = c.Data.find(v => v.playname == 'down');
	return playurls[index][1];
}

module.exports = main;
