'use strict';

function tickByFrame(onUpdate, stopTest){
	const self = this;
	return new Promise(resolve => requestAnimationFrame(function(){
		let now = performance.now();
		return function fn(timestamp){
			if(stopTest?.call(self, timestamp))return resolve();
			const timeElapsed = timestamp - now;
			now = timestamp;
			onUpdate.call(self, timeElapsed, timestamp);
			requestAnimationFrame(fn);
		}
	}()));
}

exports.tickByFrame = tickByFrame;
