
async function write(writable, data){
	const writer = writable.getWriter();
	try{
		await writer.write(data);
	}finally{
		writer.releaseLock();
	}
}

async function read(readable, handler){
	const reader = readable.getReader();
	try{
		for(;;){
			const {done, value} = await reader.read();
			if(done)break;
			handler.call(this, value);
		}
	}finally{
		reader.releaseLock();
	}
}

exports.write = write;
exports.read = read;
