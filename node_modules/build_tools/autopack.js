'use strict';

const {execSync} = require('child_process');
const path = require('path');
const watchFile = require('./watchFile');

module.exports = function(filename, main, output, args='', watchList=[]){
	const build = () => execSync(`node ${__dirname}/webpack.js ${path.join(filename, main)} ${args}`, {cwd: output}).toString();
	const log_build = () => console.log('build', build());
	watchFile(filename, log_build);
	watchList.forEach(v => watchFile(v, log_build));
	console.log('start', build());
}
