'use strict';

const fs = require('fs');

function _watchFile(filename, callback){
	return fs.watch(filename, {recursive:true}, function(eventType, filename){
		if(eventType != 'change')return;
		callback(filename);
	});
}

function watchFile(filename, callback){
	return _watchFile(filename, function(){
		let dirtyFlag = false;
		return function(){
			if(dirtyFlag)return;
			dirtyFlag = true;
			callback();
			setTimeout(() => dirtyFlag = false, 10);
		}
	}());
}

module.exports = watchFile;
