'use strict';

const EventEmitter = require('events');

class EvtSet extends Set
{
	constructor(){
		super();
		Object.defineProperty(this, 'events', {value: new EventEmitter()});
	}

	add(value){
		let exist = this.has(value);
		if(!exist){
			super.add(value);
			this.events.emit('added', value);
		}
		return this;
	}

	delete(value){
		let exist = this.has(value);
		if( exist){
			super.delete(value);
			this.events.emit('removed', value);
		}
		return exist;
	}

	listen(onAdded, onRemoved){
		this.forEach(onAdded);
		if(onAdded)
			this.events.on('added', onAdded);
		if(onRemoved)
			this.events.on('removed', onRemoved);
	}
}

module.exports = EvtSet;