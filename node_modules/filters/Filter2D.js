"use strict";

class Filter2D
{
	draw(gl, target){
		gl.render2d.submit();
		gl.render2d.save(gl.FRAMEBUFFER_BINDING, gl.CURRENT_PROGRAM);
		
		let imageFrameBuffer = gl.renderTargetMgr.getOut();
		imageFrameBuffer.active(gl);
		gl.clearColor(0, 0, 0, 0);
		gl.clear(gl.COLOR_BUFFER_BIT);
		target.onDraw(gl);
		gl.render2d.submit();

		let program = gl.programMgr.fetch(this.shader);
		gl.useProgram(program);
		gl.bindTexture(gl.TEXTURE_2D, imageFrameBuffer.colorBuffer);

		this.onDraw(gl, program);

		gl.render2d.load(gl.CURRENT_PROGRAM);
		gl.renderTargetMgr.putIn(imageFrameBuffer);
	}

	onDraw(gl, program){}
}

module.exports = Filter2D;