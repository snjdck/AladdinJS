"use strict";

class Filter2D
{
	draw(gl, target){
		let currentFrameBuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);

		let imageFrameBuffer = gl.renderTargetMgr.getOut();
		imageFrameBuffer.active(gl);
		gl.clearColor(0, 0, 0, 0);
		gl.clear(gl.COLOR_BUFFER_BIT);

		target.onDraw(gl);

		let filterFrameBuffer = gl.renderTargetMgr.getOut();
		filterFrameBuffer.active(gl);
		gl.clearColor(0, 0, 0, 0);
		gl.clear(gl.COLOR_BUFFER_BIT);

		let program = gl.programMgr.fetch(this.shader);
		gl.useProgram(program);

		gl.bindTexture(gl.TEXTURE_2D, imageFrameBuffer.colorBuffer);
		//drawFilter();
		gl.bindFramebuffer(gl.FRAMEBUFFER, currentFrameBuffer);

		gl.renderTargetMgr.putIn(imageFrameBuffer);
		gl.render2d.invalidate();
	}
}

module.exports = Filter2D;