"use strict";

const Filter2D = require("./Filter2D");

class BlurFilter extends Filter2D
{
	constructor(){
		super();
		this.shader = "shader2d&filters/blur";
	}

	onDraw(gl, program){
		let filterFrameBuffer = gl.renderTargetMgr.getOut();
		filterFrameBuffer.active(gl);
		gl.clearColor(0, 0, 0, 0);
		gl.clear(gl.COLOR_BUFFER_BIT);

		gl.uniform4fv(gl.getUniformLocation(program, "offset"), this.offset);
		gl.uniform4fv(gl.getUniformLocation(program, "offset"), this.offset);

		gl.render2d.drawScreen();

		gl.bindTexture(gl.TEXTURE_2D, filterFrameBuffer.colorBuffer);
		gl.render2d.load(gl.FRAMEBUFFER_BINDING);
		
		gl.uniform4fv(gl.getUniformLocation(program, "offset"), this.offset);
		gl.uniform4fv(gl.getUniformLocation(program, "offset"), this.offset);
		gl.render2d.drawScreen();

		gl.renderTargetMgr.putIn(filterFrameBuffer);
	}
}

module.exports = BlurFilter;