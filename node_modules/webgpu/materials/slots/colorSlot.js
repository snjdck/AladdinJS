'use strict';

const Vulkan = require('../../Vulkan');
const UniformBufferSlotCache = require('../../helper/UniformBufferSlotCache');

const {delayNew} = require('utils/cache');

module.exports = bindIndex => delayNew(() => {
	const slot = new UniformBufferSlotCache(
		Vulkan.bindGroupLayoutDict.bindGroupLayout4,
		256,
		({material}) => new Float32Array(material.color)
	);
	Vulkan.events.addEventListener('update', () => slot.clear());
	return slot;
})().bind(bindIndex);
