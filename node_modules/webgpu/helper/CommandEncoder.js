
const CommandEncoder = function*(device){
	const encoder = device.createCommandEncoder();
	yield encoder;
	device.queue.submit([encoder.finish()]);
}

const ComputePass = function*(commandEncoder){
	const encoder = commandEncoder.beginComputePass();
	yield encoder;
	encoder.end();
}

const RenderPass = desc => function*(commandEncoder, ...textureViews){
	const n = desc.colorAttachments.length;
	for(let i=0; i<n; ++i){
		desc.colorAttachments[i].view = textureViews[i];
	}
	if(desc.depthStencilAttachment){
		desc.depthStencilAttachment.view = textureViews[n];
	}
	const encoder = commandEncoder.beginRenderPass(desc);
	yield encoder;
	encoder.end();
}

exports.CommandEncoder = CommandEncoder;
exports.ComputePass = ComputePass;
exports.RenderPass = RenderPass;
