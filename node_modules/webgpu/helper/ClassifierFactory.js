'use strict';

const addFnFactory = keyFn => function(value){
	const key = keyFn(value);
	if(this.has(key)){
		this.get(key).push(value);
	}else{
		this.set(key, [value]);
	}
}

module.exports = (keyFn, sortFn) => {
	const addFn = addFnFactory(keyFn);
	const map = new Map();
	return list => {
		list.forEach(addFn, map);
		const result = Array.from(map);
		map.clear();
		return sortFn ? result.sort(sortFn) : result;
	}
}
