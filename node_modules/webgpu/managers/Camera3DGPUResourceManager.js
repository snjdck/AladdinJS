'use strict';

const Vulkan = require('../Vulkan');
const ObjectCache = require('utils/ObjectCache');

function Camera3DGPUResourceManager(){
	const cache = new ObjectCache(() => {
		const uniformBuffer = Vulkan.createBuffer(GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST, 7 * 4 * 4);

		const mvpBindGroup = Vulkan.createBindGroup('0', {buffer: uniformBuffer}, Vulkan.getSampler('linear_repeat'));

		const cullBindGroup = Vulkan.createBindGroup('2', {buffer: uniformBuffer});

		return {
			uniformBuffer,
			mvpBindGroup,
			cullBindGroup,
		}
	});
	return {
		onFrameBegin: () => cache.putAllIn(),
		getOut: () => cache.getOut(),
	}
}

module.exports = Camera3DGPUResourceManager;
