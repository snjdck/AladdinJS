"use strict";

const {interpolateKeyFrames} = require('animation/interpolate');

class Animation
{
	constructor(name, duration, trackDict){
		this.name = name;
		this.duration = duration;
		this.trackDict = trackDict;
		this.keyFrameTimes = [];
		this.offsetData = [];
	}

	calcTransform(boneID, time, result){
		return interpolateKeyFrames(this.keyFrameTimes, this.trackDict[boneID], time, result);
	}

	copyFirstFrameToEnd(timeToAdd=1){
		this.duration += timeToAdd;
		this.keyFrameTimes.push(this.keyFrameTimes.at(-1) + timeToAdd);
		this.offsetData.push(this.offsetData[0]);
		for(let keyFrameList of Object.values(this.trackDict)){
			keyFrameList.push(keyFrameList[0]);
		}
	}

	removeLastFrame(timeToDel=1){
		this.duration -= timeToDel;
		this.keyFrameTimes.pop();
		this.offsetData.pop();
		for(let keyFrameList of Object.values(this.trackDict)){
			keyFrameList.pop();
		}
	}
}

module.exports = Animation;