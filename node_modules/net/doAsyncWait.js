
module.exports = (target, event, timeout, match, callback) => new Promise((resolve, reject) => {
	const timer = setTimeout(() => {
		target.off(event, onCall);
		reject('timeout');
	}, timeout * 1000);
	const onCall = (...args) => {
		if(!match(...args))return;
		target.off(event, onCall);
		clearTimeout(timer);
		resolve(callback(...args));
	};
	target.on(event, onCall);
});