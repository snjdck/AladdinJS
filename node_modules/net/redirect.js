'use strict';

const {createServer, connect} = require('net');
const options = {pauseOnConnect:true};

function parse(address){
	const info = address.split(':');
	return [parseInt(info[1]), info[0]];
}

function redirect(from, to){
	const [port, host] = parse(to);
	createServer(options, client => connect(port, host, function(){
		this.pipe(client);
		client.pipe(this);
		client.resume();
	}).on('error', () => client.destroy()
	)).listen(...parse(from));
}

module.exports = redirect;
