
const {Service} = require('mvc');
const tcp = require('net/tcp');
const Packet = require('net/tcp/Packet');
const MsgIds = require('./MsgIds');

class NetService extends Service
{
	init(socket){
		this.request = tcp(socket, Packet);
		socket.on('notify', (msgId, payload) => {
			let msgName = MsgIds[msgId];
			if(!msgName)return;
			this.notify(msgName, payload);
		}).on('close', hadError  => {
			console.log('socket closed!');
		});
	}
}

module.exports = NetService;