'use strict';

const castTextFn = (pattern => replaceFn => v => v.replace(pattern, replaceFn))(/[^\x00-\xff]/g);

exports.castUnicode = castTextFn(v => '\\u' + v.charCodeAt(0).toString(16).padStart(4, '0'));

exports.castUTF8 = castTextFn(function(){
	const encoder = new TextEncoder();
	const mapFn = v => '\\x' + v.toString(16).padStart(2, '0');
	return v => Array.from(encoder.encode(v), mapFn).join('');
}());

exports.tab = function(){
	const pattern = /.*\n|.+$/g;
	return text => text.replace(pattern, '\t$&');
}();

exports.untab = function(){
	const pattern = /^\t/gm;
	return text => text.replace(pattern, '');
}();
