'use strict';

const call = fn => fn();

function deferDo(){
	const taskList = [];
	const enqueue = task => taskList.push(task);
	const execute = () => {
		if(taskList.length <= 0)return;
		taskList.forEach(call);
		taskList.length = 0;
	}
	return [enqueue, execute];
}

function deferBunchDo(handler, prepare){
	const taskList = [];
	const enqueue = task => taskList.push(task);
	const execute = (...args) => {
		if(taskList.length <= 0)return;
		prepare(...args);
		handler(taskList);
		taskList.length = 0;
	}
	return [enqueue, execute];
}

exports.deferDo = deferDo;
exports.deferBunchDo = deferBunchDo;
