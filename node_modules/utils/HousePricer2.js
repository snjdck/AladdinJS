const monthBase = 0.049 / 12;
const gjj = 4.9 / 3.25;

const f0 = (monthRate, numMonth) => monthRate + monthRate / ((1 + monthRate) ** numMonth - 1);
const f1 = (monthRate, numMonth) => monthRate + 1 / numMonth;
const fn = (f, factor, numMonth) => f((factor * 0.01 + 1) * monthBase, numMonth);

function calc(numYear, interestRate, f=f0, justInterestFlag=interestRate*numYear*12<1){
	const numMonth = numYear * 12;
	if(f === f1){
		if(!justInterestFlag){
			interestRate -= 1 / numMonth;
		}
		return (interestRate / monthBase - 1) * 100;
	}
	const value = interestRate + (justInterestFlag ? 1 / numMonth : 0);
	let i = -40;
	let a = fn(f, i, numMonth);
	if(value < a)return -100;
	for(;;++i){
		let b = fn(f, i+1, numMonth);
		if(a <= value && value < b)
			return i;
		a = b;
	}
}

function print(numYear, total, interest, f, justInterestFlag){
	let factor = calc(numYear, interest / total * 0.0001, f, justInterestFlag);
	let flag = factor < 0;
	if(flag){
		factor = (100 + factor) * gjj - 100;
	}
	console.log(
		total.toString().padStart(2) + '万',
		numYear.toString().padStart(2) + '年',
		interest.toString().padStart(10) + '月供',
		flag ? '公积金' : '  商贷',
		'上浮' + factor + '%'
	);
}

print(8, 17, 556);
print(5,  8, 256);
print(8, 18, 459.38);
print(8, 17, 2195);
print(8, 17, 2203);
print(8, 17, 2303.25);
print(5, 15, 3112.5);
print(30, 52, 3800, f1);
print(20, 45, 3200, f1);
