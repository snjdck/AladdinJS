'use strict';

const {cut} = require('./array/cut');
const {zip} = require('./array/zip');
const {calcSize} = require('./array/reduce');

const limitSend = (sendFn, limit=20) => async data => {
	for(let v of cut(data, limit)){
		await sendFn(v);
	}
}

function to_frame(data, frameSize, payloadFn){
	const frameList = Array.from(cut(data, frameSize));
	return zip(payloadFn ? frameList.map(payloadFn) : frameList, calcSize(frameList));
}

exports.limitSend = limitSend;
exports.to_frame = to_frame;
