'use strict';

const limitSend = (sendFn, limit=20) => async data => {
	for(let v of cut(data, limit)){
		await sendFn(v);
	}
}

function*cut(data, limit=20){
	const length = data instanceof ArrayBuffer ? data.byteLength : data.length;
	if(length <= limit)return yield data;
	let offset = 0;
	do{
		yield data.slice(offset, offset + limit);
		offset += limit;
	}while(length - offset > limit);
	yield data.slice(offset);
}

exports.limitSend = limitSend;
