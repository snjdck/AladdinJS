
const removeCircleRef = (next_id, clear_next) => id => {
	for(let set=[]; id; id=next_id(id)){
		if(set.includes(id)){
			clear_next(set.pop());
			break;
		}
		set.push(id);
	}
}

const removeCircleRef1 = dict => removeCircleRef(id => dict[id]?.next, id => dict[id].next = null);

exports.removeCircleRef = removeCircleRef;
exports.removeCircleRef1 = removeCircleRef1;
