
function write(value, fn){
	const result = [];
	while(fn(value)){
		result.push(0x80 | (value & 0x7F));
		value >>= 7;
	}
	result.push(value & 0x7F);
	return result;
}

const testU = v => v >= 0x80;
const testP = v => v >= 0x40;
const testN = v => (v >> 6) != -1;

const write_u32v = v => write(v, testU);
const write_i32v = v => write(v, v >= 0 ? testP : testN);
//*
exports.gen_vuint = write_u32v;
exports.write_u32v = write_u32v;
exports.write_i32v = write_i32v;
//*/
/*
const test = (f, v, result) => console.assert(f(v).map(v => v.toString(16).padStart(2, '0')).join('') == result);

test(write_u32v, 0x3239, 'b964');
test(write_u32v, 16256, '807f');
test(write_i32v,  -128, '807f');
test(write_i32v,  -2, '7e');
//*/