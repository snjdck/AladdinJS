'use strict';

const XML = require('./xml/decode');
const {toObject} = require('utils/array/everyN');

function read(element){
	switch(element.nodeName){
		case 'string': 	return element.textContent;
		case 'dict': 	return toObject(element.children, castKV);
		case 'array': 	return Array.from(element.children, read);
		case 'true': 	return true;
		case 'false': 	return false;
		case 'integer': return parseInt(element.textContent);
		case 'real': 	return parseFloat(element.textContent);
	}
	throw element;
}

const castKV = ([k, v]) => [k.textContent, read(v)];
const decode = text => read(XML(text).children[0]);

exports.decode = decode;