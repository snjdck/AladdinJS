
function newMap(w, h){
	const map = new Array(w * h).fill(0);
	return function(x, y, value){
		if(x === undefined)return map;
		const index = w * y + x;
		if(value === undefined)
			return map[index];
		map[index] = value;
	}
}

function lcs(x, y){
	const m = x.length;
	const n = y.length;
	const c = newMap(m+1, n+1);
	for(let i=0; i<m; ++i){
		for(let j=0; j<n; ++j){
			const value = x[i] == y[j] ? c(i, j) + 1 : Math.max(c(i, j+1), c(i+1, j));
			c(i+1, j+1, value);
		}
	}
	return c();
}

console.log(lcs([1,2,3,2,4,1,2],[2,4,3,1,2,1]));