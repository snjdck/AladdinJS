
const NodeType = require('./NodeType');
const testRule = require('./RuleList');
const Node = require('./Node');
const NodeList = require('./NodeList');
const buildTree = require('./buildTree');

function lexer(input){
	const outputNodeList = new NodeList();
	const spaceRegExp = /^\s+/;
	while(input.length > 0){
		const spaceTest = spaceRegExp.exec(input);
		if(spaceTest){
			input = input.slice(spaceTest[0].length);
			continue;
		}
		let result = testRule(input);
		if(!result){
			console.log('not matched');
			break;
		}
		outputNodeList.add(new Node(...result));
		input = input.slice(result[1].length);
	}
	outputNodeList.add(new Node(NodeType.EOF));
	return outputNodeList;
}

console.log(buildTree(lexer("1 = 2 = 3 = 4")).calcute())
console.log(buildTree(lexer("1 + 2 + 3 + ---+++4")).calcute())
//console.log(lexer("if(5 > 0)console.log(100)", ruleList))