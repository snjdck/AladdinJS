"use strict";

const Material = require("./Material");
const {RenderState} = require("../renderers");
const WebGL = require('../WebGL');
const {ProgramName} = require('../const');

class TextureMaterial extends Material{
	constructor(texture){
		super(ProgramName.shader3d_normal);
		this.texture = texture;
		this.renderState = RenderState.Texture;
	}

	onDraw(drawUnit, index, batchIndex){
		let {render3d:{uniformBuffer}} = WebGL;
		let {boneMatrixList} = drawUnit;
		uniformBuffer.setFloatv(4 + index * boneMatrixList.length, boneMatrixList);
		if(index == 0 && batchIndex == 0){
			let {vao:{bindCount, boneCount}} = drawUnit;
			uniformBuffer.setInts(0, bindCount, boneCount);
		}
	}
}

module.exports = TextureMaterial;