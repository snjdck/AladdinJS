"use strict";

const DisplayObject3D = require("./DisplayObject3D");
const Camera3D = require("./cameras/Camera3D");

class Scene3D
{
	constructor(){
		this.root = new DisplayObject3D();
		this.cameraList = [];
	}

	update(){
		this.root.onUpdate();
	}

	draw(mode){
		const {root, cameraList} = this;
		root.forEach(collectCameras, cameraList);
		cameraList.sort(sortCameras);
		for(let camera of cameraList){
			camera.render(root, mode);
		}
		cameraList.length = 0;
	}
}

function collectCameras(node){
	if(node instanceof Camera3D){
		this.push(node);
	}
}

const sortCameras = (l, r) => l.depth - r.depth;

module.exports = Scene3D;