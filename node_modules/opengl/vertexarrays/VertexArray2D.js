"use strict";

const WebGL = require('../WebGL');
const {createMeshIndices} = require("utils/geometry");
const VertexArray = require("./VertexArray");

class VertexArray2D extends VertexArray
{
	static new(){
		return instance;
	}

	onCreate(gl){
		let vertexData = new Float32Array([
			0, 0, 0, 0, 0, 0,
			0, 0, 1, 0, 0, 0,
			1, 0, 0,-1, 0, 0,
			1, 0, 0, 0, 0, 0,
			
			0, 0, 0, 0, 1, 0,
			0, 0, 1, 0, 1, 0,
			1, 0, 0,-1, 1, 0,
			1, 0, 0, 0, 1, 0,
			
			0, 1, 0, 0, 0,-1,
			0, 1, 1, 0, 0,-1,
			1, 1, 0,-1, 0,-1,
			1, 1, 0, 0, 0,-1,
			
			0, 1, 0, 0, 0, 0,
			0, 1, 1, 0, 0, 0,
			1, 1, 0,-1, 0, 0,
			1, 1, 0, 0, 0, 0
		]);
		let indexData = new Uint8Array(createMeshIndices(4, 4));
		
		super.onCreate(gl, vertexData, indexData);

		gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 24, 0);
		gl.vertexAttribPointer(1, 4, gl.FLOAT, false, 24, 8);

		gl.enableVertexAttribArray(0);
		gl.enableVertexAttribArray(1);
	}

	draw(instanceCount=1){
		let {gl} = WebGL;
		gl.drawElementsInstanced(gl.TRIANGLES, 54, gl.UNSIGNED_BYTE, 0, instanceCount);
	}
}

const instance = new VertexArray2D();

module.exports = VertexArray2D;