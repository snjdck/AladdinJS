
function batchDraw(instanceList, instanceCountPerDraw){
	const totalInstanceCount = instanceList.length;
	if(totalInstanceCount <= 0)return 0;
	this.onPrepareBuffer(Math.min(totalInstanceCount, instanceCountPerDraw));
	let instanceIndex = 0;
	let drawCount = 0;
	while(instanceIndex < totalInstanceCount){
		this.onBatchBegin();
		const instanceCount = Math.min(instanceCountPerDraw, totalInstanceCount - instanceIndex);
		for(let i=0; i<instanceCount; ++i){
			const instance = instanceList[instanceIndex+i];
			this.onUpdateBuffer(instance, i);
		}
		instanceIndex += instanceCount;
		++drawCount;
		this.onUploadBuffer(instanceCount);
		this.onDraw(instanceCount);
	}
	return drawCount;
}

module.exports = batchDraw;