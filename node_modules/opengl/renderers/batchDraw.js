
function batchDraw(instanceCountPerDraw, instanceList, from=0, to=instanceList.length, ...args){
	const totalInstanceCount = to - from;
	if(totalInstanceCount <= 0)return 0;
	this.onPrepareBuffer(Math.min(totalInstanceCount, instanceCountPerDraw));
	let instanceIndex = 0;
	let drawCount = 0;
	while(instanceIndex < totalInstanceCount){
		const instanceCount = Math.min(instanceCountPerDraw, totalInstanceCount - instanceIndex);
		for(let i=0; i<instanceCount; ++i){
			const instance = instanceList[from+instanceIndex+i];
			this.onUpdateBuffer(instance, i, drawCount);
		}
		this.onUploadBufferAndDraw(instanceCount, ...args);
		instanceIndex += instanceCount;
		++drawCount;
	}
	return drawCount;
}

module.exports = batchDraw;