'use strict';

const mat4 = require('../math/mat4');

class ViewFrustum
{
	constructor(){
		this.matrix = new Array(16);
		this.planeList = [new Array(4),new Array(4),new Array(4),new Array(4)];
	}

	update(camera){
		const {matrix} = this;
		const {rotation, translation} = camera.worldTransformInvert;

		rotation.toMatrix(matrix, translation);
		mat4.concat(matrix, camera.lens, matrix);
		mat4.calc_planes(matrix, this.planeList);
	}

	canCull(aabb){
		return mat4.cull_aabb(this.planeList, aabb);
	}
}

module.exports = ViewFrustum;